<html>
<head>
	<!-- kube stylesheet -->
	<link rel="stylesheet" type="text/css" href="css/kube101/css/kube.css" />
	<!-- local stylesheet -->
	<link rel="stylesheet" href="css/blauncher.css" type="text/css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script type="text/javascript">
		//global variable
		book_PIDS = [];

		function drawThumbs(){
			for (var i = 0; i < book_PIDS.length; ++i){			
				$("#item_thumbs").append("<div class='fifth'><a href='bookreader.htm?ItemID="+book_PIDS[i]+"#page/1/mode/2up'><img class='shadow' src='http://141.217.172.45/fedora/objects/"+book_PIDS[i].split(':')[1]+":thumbs/datastreams/THUMB_1/content'/></a><div class='row container'><div class='thumb_text'><em>"+book_PIDS[i]+"</em></div></div></div>")
			}
		}
	</script>
</head>

<body>

<div id="container">

	<div id="title" class="row">
		<h3>WSU eReader - Ramsey Collection example books</h3>
	</div>

	<script type="text/javascript">
	$(document).ready(function() {
        // test url
        dataObject = new Object();        
        dataObject.data_type = "html";

        // dataObject.data_type = "json";
        var baseURL = "http://141.217.172.45/fedora/risearch?";
        var queryOptions = "type=tuples&lang=itql&format=json&dt=on&stream=on&query=";
        var baseQuery = "select $subject from <#ri> where $subject <fedora-rels-ext:hasContentModel> <fedora:singleObjectCM:WSUebook>";
        dataObject.encodedQueryURL = baseURL + queryOptions + encodeURIComponent(baseQuery);        

		//returns json
        $(document).ready(function(){
          $.ajax({
            type: "POST",
            url: "php/ebook_object_tunnel.php",
            data: dataObject,
            dataType: "json",
            success: pull_meta
          });
        });

        function pull_meta(response){               
            console.log(response);

            // create list of PIDs that match query            
            for (var i = 0; i < response.results.length; ++i){  
            	book_PIDS.push(response.results[i].subject.split('/')[1]);            	            	
        	}

        	//do it!
        	drawThumbs();
    	}

	});
	</script>

	<div id='item_thumbs'>
		
		<!--
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// function createThumb($item_ID){
		// 	echo "<div class='fifth'><a href='bookreader.htm?ItemID=ramsey:$item_ID#page/1/mode/2up'><img class='shadow' src='../data/$item_ID/".$item_ID."_cover.jpg'/></a>";
		// 	echo 	"<div class='row container'>";
	 	//        echo 		"<div class='thumb_text'><em>$item_ID</em></div>";			          
		// 	echo 	"</div>";
		// 	echo "</div>";
		// }
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////		
		-->
	</div>

</div>

</body>
</html>










